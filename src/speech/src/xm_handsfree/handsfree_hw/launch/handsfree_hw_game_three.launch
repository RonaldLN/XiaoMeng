<?xml version="1.0"?>
<launch>
<!--joint_state_publishser for pub joint_state-->
<!--robot_state_publisher for tf which need topic /joint_state-->
   
  <include file="$(find rplidar_ros)/launch/rplidar_s2.launch"/>
  <include file="$(find laser_filters)/examples/box_filter_example.launch"/>
<include file="$(find xm_2dnav)/launch/dwa_astar_move_base.launch"/>

  <node name="handsfree_hw_node" pkg="handsfree_hw" type="handsfree_hw_node" output="screen" >
  <param name="sim_xm" type="bool" value="false" />
  <param name="controller_freq_" type="double" value="100.0" />
  </node>

  <!--param name="robot_description" textfile="$(find xm_description)/urdf/xm.urdf" /-->

  <include file="$(find base_server)/launch/xm_base_server.xml"/>
  
    <!--node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" respawn="true"-->
      <!--param name="publish_frequency" type="double" value="50.0" /-->
      <!--useful...no -->
      <!--remap from="/joint_states" to="mobile_base/joint_states"/-->
    <!--/node-->
    <!--joint_state_publisher is used for making the /joint_state avaible -->
    <!--node name="joint_state_publisher" pkg="joint_state_publisher" type="joint_state_publisher">
      <param name="/use_gui" value="false"/>
      <rosparam param="/source_list">[/mobile_base/joint_states]</rosparam>
    </node-->

  <!--nodelet fun may not be used , if you want to premote it ,please see how to use the nodelet, xuezhang is too lazy^_^  -->
  <!--肖：该死，这明显完全没起作用啊-->
  <node pkg="nodelet" type="nodelet" name="nodelet_manager" args="manager"/>
  	<node pkg="nodelet" type="nodelet" name="velocity_smoother" 
	    args="load xm_velocity_smoother/VelocitySmootherNodelet nodelet_manager"   output="screen">
    <rosparam file="$(find xm_velocity_smoother)/param/standalone.yaml" command="load"/>
	  <remap from="velocity_smoother/raw_cmd_vel" to="/mobile_base/mobile_base_controller/cmd_vel"/>
      <remap from="velocity_smoother/smooth_cmd_vel" to="/mobile_base/mobile_base_controller/smooth_cmd_vel"/>
      <remap from="/velocity_smoother/odometry" to="/mobile_base/mobile_base_controller/odom"/>
   </node>
      <!--xiao尝试<remap from="velocity_smoother/raw_cmd_vel" to="/mobile_base/mobile_base_controller/cmd_vel"/>
      <remap from="velocity_smoother/smooth_cmd_vel" to="/mobile_base/mobile_base_controller/smooth_cmd_vel"/>
      <remap from="/velocity_smoother/odometry" to="/mobile_base/mobile_base_controller/odom"/>-->
        
  <include file="$(find handsfree_hw)/launch/xm_controller.xml"/>
  
  <!--<include file="$(find xm_arm_server)/launch/xm_arm_server.launch"/>-->

<node pkg="tf" type="static_transform_publisher" name="test_tf_broadcaster" args="0 0 0 0 0 0 1 base_footprint base_link 100" />
<node name="rviz" pkg="rviz" type="rviz" required="true"
      args="-d $(find handsfree_hw)/dwa_astar.rviz" />
<include file="$(find handsfree_hw)/launch/keyboard_teleop.launch"/>
</launch>
